\documentclass{book}
%letterpaper,10pt,twoside,onecolumn,titlepage,openright,final

\usepackage{xeCJK}
%language support CJK

%\usepackage[OT2,T1]{fontenc}
\usepackage[french,russian,greek,english]{babel}
\usepackage{geometry}
%packageometry save us from calculate parameters that affect each other
\geometry{inner=1.5cm,outer=1.5cm,top=2cm,bottom=2cm}

%out margin in (ams)book class
\usepackage{graphicx}
%insert external pictures
%usage \includegraphicx[]{}
%parameter in [] : width, height, = ?cm scale = 0.6
\usepackage[fulladjust]{marginnote}
%\setlength{\marginparsep}{5mm}
%\setlength{\marginparwidth}{1in}
%\marginnote instead of \marginpar
\usepackage{xcolor}
\definecolor{hekishoku}{RGB}{0,127,137}
\definecolor{soga}{RGB}{243,244,127}
\definecolor{usukihada}{RGB}{249,241,192}
\definecolor{tokiiro}{RGB}{243,166,150}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{mizu}{RGB}{127,204,227}
\definecolor{ao}{RGB}{0,149,217}
\definecolor{kohaku}{RGB}{234,147,10}
\definecolor{daidai}{RGB}{238,120,0}

\usepackage{hyperref}
\hypersetup{
    colorlinks,
    linkcolor=blue,
    citecolor=blue,
    urlcolor=blue
}

\usepackage{amsmath}
\usepackage{amssymb}
%amsmath and ntheorem should be loaded before {fontspec}
%\usepackage{mathtools}
%offer pmatirx*
\usepackage{ulem}
%\uline{}, \uuline{}, \uwave{},\sout{},b\xout{},\dashuline{},\dotuline{},\sout{}(words only)
\usepackage{cancel}
%\cancel{} can be used in formulae!\bcancel{}\xcancle{}\cancelto{<value>}{<expression>}
\usepackage{extarrows}

\usepackage{fontspec,unicode-math}
%unicode-math should be loaded after any othermaths or font-related package in case it needs to overwrite their definitions.
\setmonofont{Courier New}%英文等宽字体
\setsansfont{Noto Sans} %设置无衬线英文字体
\setmainfont{Noto Serif}%{Latin Modern Roman} %设置衬线英文字体，
\setmathfont{STIX Two Math}
\setmathfont{STIX Two Math}[
	range={scr,bfscr},StylisticSet=01
	]
\xeCJKsetup{AutoFakeSlant={true}}
\setCJKmainfont[ItalicFont={FZNewKai-Z03}, BoldFont={Source Han Serif Bold}]{Source Han Serif}  %中文字体设置
\setCJKsansfont{Hiragino Sans GB} %设置中文无衬线字体
\setCJKmonofont{HanaMinA} %设置中文等宽字体字体



\usepackage{listings}
\lstdefinestyle{mystyle_py}{
	backgroundcolor=\color{usukihada},
	commentstyle=\color{hekishoku},
	keywordstyle=\color{ao},
	numberstyle=\tiny\color{codegray},
	stringstyle=\color{daidai}\ttfamily,
	basicstyle=\scriptsize\ttfamily,
	extendedchars=true,
	breakatwhitespace=false,
	breaklines=true,
	captionpos=b,
	keepspaces=true,
	frame=lines,
	numbers=left,
	numbersep=5pt,
	showspaces=false,
	showstringspaces=false,
	showtabs=false,
  	tabsize=4,
	emph=[1]{False, None, True, and, as, assert, async, await, break, class, continue, def, del, elif, else, except, finally, for, from, global, if, import, in, is, lambda, nonlocal, not, or, pass, raise, return, try, while, with, yield},
	emphstyle = [1]\color{ao},
	% Built-ins
	emph=[2]{abs,all,any,basestring,bin,bool,bytearray,callable,chr,classmethod,cmp,compile,complex,delattr,dict,dir,divmod,enumerate,eval,execfile,file,filter,float,format,frozenset,getattr,globals,hasattr,hash,help,hex,id,input,int,isinstance,issubclass,iter,len,list,locals,long,map,max,memoryview,min,next,object,oct,open,ord,pow,property,range,raw_input,reduce,reload,repr,reversed,round,set,setattr,slice,sorted,staticmethod,str,sum,super,tuple,type,unichr,unicode,vars,xrange,zip,apply,buffer,coerce,intern},
	emphstyle = [2]\color{ao}
}

\lstdefinestyle{mystyle_cpp}{
	backgroundcolor=\color{OCM_08},
	commentstyle=\color{OCM_01},
	keywordstyle=\color{OCM_04},	
	numberstyle=\tiny\color{codegray},
	stringstyle=\color{OCM_03}\ttfamily,
	basicstyle=\color{OCM_07}\scriptsize\ttfamily,
	extendedchars=true,
	breakatwhitespace=false,
	breaklines=true,
	captionpos=b,
	keepspaces=true,
	frame=lines,
	numbers=left,
	numbersep=5pt,
	showspaces=false,
	showstringspaces=false,
	showtabs=false,
  	tabsize=4,
	emph=[2]{alignas, alignof, and, and_eq, asm, atomic_cancel, atomic_commit,atomic_noexcept, auto,
	bitand, bitor, bool, break,
	case, catch, char, char8_t, char16_t, char32_t, class, compl, concept, const, consteval, constexpr, constinit, const_cast, continue, co_await, co_return, co_yield,
	decltype, default, delete, do, double, dynamic_cast,
	else, enum, explicit, export, extern,
	false, float, for, friend,
	goto,
	if, inline, int, long,
	mutable, namespace, new, noexcept, not, not_eq, nullptr,
	operator, or, or_eq, private, protected, public,
	reflexpr, register, reinterpret_cast, requires, return,
	short, signed, sizeof, static, static_assert, static_cast, struct, switch,synchronized,
	template, this, thread_local, throw, true, try, typedef, typeid, typename,
	union, unsigned, using, virtual, void, volatile,
	wchar_t, while, xor, xor_eq},
	emphstyle = [2]\color{OCM_02}
	empi=[3]{
		if, elif, else, endif, ifdef, ifndef,
		define, undef, include, line,
		error, pragma, defined,
		__has_include, __has_cpp_attribute,
		export, import, module
	},
	emphstyle = [3]\color{OCM_04}
}

\def\inline{\lstinline[style=mystyle_py]}
\usepackage{tcolorbox}
\tcbuselibrary{listings,skins,breakable,fitting,raster,xparse,external}
\tcbset{
	colback=red!5!white,
	colframe=red!75!black
	}
\newtcolorbox[auto counter,number within=chapter,list inside=columns]{special_columns}[2][]{
	colback=yellow!2!red!2!white,
	colframe=magenta!15!orange!75!white,
	fonttitle=\bfseries,breakable,enhanced,
	title=专栏: #2,#1}

\newcommand{\listofcolumns}{%
  \tcblistof[\chapter*]{columns}{List of Column Boxes}
}
\usepackage{multicol,multirow,booktabs,makecell,array,colortbl}
\usepackage{varwidth}
\usepackage{titlesec,titletoc,etoc}
\usepackage{caption,subcaption}
\usepackage{enumitem}
\setlist{noitemsep}
\setlist[itemize,enumerate,1]{labelindent=\parindent,leftmargin=*}
\setlist[enumerate,1]{label=\fbox{\arabic*.}}

\usepackage{tikz,pgf,pgfplots,pgfplotstable}
\usetikzlibrary{shapes, arrows.meta, trees, chains, positioning, shadows, calc,intersections,math,babel,cd}
\usepgfplotslibrary{external} 

\pgfplotsset{compat=newest}
\usepackage{pdfpages}
\usepackage[linesnumbered,lined,ruled,commentsnumbered]{algorithm2e}

\usepackage{csquotes}
\usepackage[backend=biber]{biblatex}
\addbibresource{math_bib_file.bib}



\usepackage{amsthm,thmtools}
\let\proof\relax
\let\endproof\relax
\def\thmbegin{\raisebox{0.35ex}{$\scriptstyle\blacktriangleright$}\hspace{0.3em}}
\def\defbegin{\raisebox{0.2ex}{$\displaystyle\maltese$}\hspace{0.3em}}
\declaretheoremstyle[
spaceabove=6pt, spacebelow=6pt,
headfont=\normalfont\bfseries,
notefont=\mdseries, notebraces={(}{)},
headpunct ={:},
headformat=\thmbegin\NAME~\NUMBER \NOTE,
bodyfont=\normalfont\itshape,
postheadspace=1em,
]{general_thm_style}
\declaretheoremstyle[
spaceabove=6pt, spacebelow=6pt,
headfont=\normalfont\bfseries,
notefont=\mdseries, notebraces={(}{)},
headpunct ={:},
headformat=\defbegin\NAME~\NUMBER \NOTE,
bodyfont=\normalfont\itshape,
postheadspace=1em,
]{def_style}
\declaretheorem[numberwithin=chapter, name=Theorem, style=general_thm_style]{theorem}
\declaretheorem[sibling=theorem, name=Proposition, style=general_thm_style]{proposition}
\declaretheorem[sibling=theorem, name=Definition, style=def_style]{definition}
\declaretheorem[sibling=theorem, name=Lemma, style=general_thm_style]{lemma}
\declaretheorem[sibling=theorem, name=Corollary, style=general_thm_style]{corollary}
\declaretheorem[numberwithin=section, name=e.g.]{example}
\declaretheorem[numberwithin=chapter, name=e.x.]{exercise}
\declaretheorem[numberwithin=chapter, name=Remark]{remark}

\declaretheoremstyle[
spaceabove=6pt, spacebelow=6pt,
headfont=\normalfont\itshape,
notefont=\mdseries, notebraces={(}{)},
bodyfont=\normalfont,
postheadspace=1em,
headpunct={:},
headformat=\underline{\NAME \NOTE},
qed=\qedsymbol
]{proof_style}
\declaretheorem[numbered=no, name=Proof, style=proof_style]{proof}

\declaretheoremstyle[
spaceabove=6pt, spacebelow=6pt,
headfont=\normalfont\itshape,
notefont=\mdseries, notebraces={(}{)},
bodyfont=\normalfont,
postheadspace=1em,
headpunct={:},
headformat=\underline{\NAME \NOTE},
qed=$\blacksquare$
]{solution_style}
\declaretheorem[numbered=no, name=Solution, style=solution_style]{solution}



\numberwithin{equation}{section}
\newcommand{\Res}{\mathrm{Res\mathop{}}}
\newcommand{\NaN}{\texttt{NaN}}
\newcommand{\Card}{\mathrm{Card\mathop{}}}
\newcommand{\Rank}{\mathrm{Rank\mathop{}}}
\newcommand{\Var}{\operatorname{Var\mathop{}}}
\newcommand{\Cov}{\operatorname{Cov\mathop{}}}
\newcommand{\Div}{\operatorname{Div\mathop{}}}
\newcommand{\Hom}{\mathbf{Hom}}
\newcommand{\Iso}{\mathbf{Iso}}
\newcommand{\Aut}{\mathbf{Aut}}
\newcommand{\End}{\mathbf{End}}
\newcommand{\Ker}{\mathrm{Ker\mathop{}}}
\newcommand{\Img}{\mathrm{Im\mathop{}}}
\newcommand{\Intr}{\mathrm{Int\mathop{}}}
\newcommand{\abs}[1]{\left\vert #1 \right\vert}
%Absolute value notation
\newcommand{\norm}[1]{\left\Vert #1 \right\Vert}
%Norm notation
\newcommand{\diff}{\mathop{}\!\textrm{d}}

\newcommand{\marginnoteteal}[1]{\marginnote{\textcolor{teal}{#1}}}

\newcommand\doverline[1]{%
		\tikz[baseline=(nodeAnchor.base)]{
			\node[inner sep=0] (nodeAnchor) {$#1$}; 
			\draw[line width=0.1ex,line cap=round] 
				($(nodeAnchor.north west)+(0.0em,0.2ex)$) 
					--
				($(nodeAnchor.north east)+(0.0em,0.2ex)$) 
				($(nodeAnchor.north west)+(0.0em,0.5ex)$) 
					--
				($(nodeAnchor.north east)+(0.0em,0.5ex)$) 
			;
		}
	}

%indispensable!
\title{MEMORANDVM MATHEMATICVS}
\author{\href{mailto:zvezda_wang@hotmail.com}{Johannes E}}
\date{Last Updated on: \today}


%    \thanks will become a 1st page footnote.

\begin{document}

\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{2}

\maketitle

{
	\let\cleardoublepage\clearpage
	\newgeometry{inner=1.5cm,outer=1.5cm,top=1.5cm,bottom=1.5cm}
	{
	\setcounter{tocdepth}{1}
	\renewcommand{\contentsname}{Brief Contents}
	\begin{multicols}{2}
		\tableofcontents
	\end{multicols}	
	\addcontentsline{toc}{section}{简明目录}

	}

	{
	\setcounter{tocdepth}{4}
	\renewcommand{\contentsname}{Detailed Contents}
	\tableofcontents
	\addcontentsline{toc}{section}{详细目录}
	}
	\restoregeometry

}

\include{Math}
\include{Application}
\include{Miscellaneous}

\end{document}
